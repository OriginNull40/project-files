<!DOCTYPE html>
<html>
<head>
    <title>Mednafen PSX Core</title>
    <style>
        body{margin:0;background:#000;color:#0f0;font-family:monospace;padding:20px;}
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body>
    <div id="status">> KERNEL ONLINE. SYNCING FEED...</div>
    <div id="webrcade-app-root"></div>

    <script src="../webrcade-core.js"></script>
    
    <script>
        const params = new URLSearchParams(window.location.search);
        const feedUrl = params.get('feed');

        // Load the Mednafen Engine
        const engineScript = document.createElement('script');
        engineScript.src = 'mednafen_psx_libretro.js'; 
        
        engineScript.onload = () => {
            document.getElementById('status').innerText = "> ENGINE READY. LAUNCHING FFVII...";
            
            // This is the trigger that actually starts the game using the local engine
            if (window.WebRcadePlayer) {
                const player = new window.WebRcadePlayer("webrcade-app-root");
                player.loadFeed(feedUrl);
            } else {
                document.getElementById('status').innerText = "> ERROR: WebRcadePlayer NOT FOUND";
            }
        };

        document.head.appendChild(engineScript);
    </script>
</body>
</html>
